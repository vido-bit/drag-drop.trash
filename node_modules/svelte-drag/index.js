function ue(e,n){var r=n?.cache??be,a=n?.serializer??pe,o=n?.strategy??he;return o(e,{cache:r,serializer:a})}function de(e){return e==null||typeof e=="number"||typeof e=="boolean"}function fe(e,n,r,a){var o=de(a)?a:r(a),i=n.get(o);return typeof i=="undefined"&&(i=e.call(this,a),n.set(o,i)),i}function ge(e,n,r){var a=Array.prototype.slice.call(arguments,3),o=r(a),i=n.get(o);return typeof i=="undefined"&&(i=e.apply(this,a),n.set(o,i)),i}function me(e,n,r,a,o){return r.bind(n,e,a,o)}function he(e,n){var r=e.length===1?fe:ge;return me(e,this,r,n.cache.create(),n.serializer)}var pe=JSON.stringify;function X(){this.cache=Object.create(null)}X.prototype.has=function(e){return e in this.cache};X.prototype.get=function(e){return this.cache[e]};X.prototype.set=function(e,n){this.cache[e]=n};var be={create:function(){return new X}},_=ue;var b={MAIN:"svelte-draggable",DRAGGING:"svelte-draggable-dragging",DRAGGED:"svelte-draggable-dragged"},Le=(e,n={})=>{let{bounds:r,axis:a="both",gpuAcceleration:o=!0,applyUserSelectHack:i=!0,disabled:x=!1,ignoreMultitouch:H=!1,grid:v,position:E,cancel:m,handle:h,defaultClass:S=b.MAIN,defaultClassDragging:Y=b.DRAGGING,defaultClassDragged:y=b.DRAGGED,defaultPosition:Me={x:0,y:0},onDragStart:te,onDrag:ne,onDragEnd:re}=n,F=new Promise(requestAnimationFrame),D=!1,[l,c]=[0,0],[M,T]=[0,0],[z,I]=[0,0],{x:C,y:R}={x:E?.x??0,y:E?.y??0};j(C,R,e,o);let w,k,K="",f,g,P,U,ae=!!E,q=()=>({offsetX:l,offsetY:c,domRect:e.getBoundingClientRect()});function oe(t){let s=q();t.dispatchEvent(new CustomEvent("svelte-drag:start",{detail:s})),te?.(s)}function ie(t){let s=q();t.dispatchEvent(new CustomEvent("svelte-drag:end",{detail:s})),re?.(s)}function se(t){let s=q();t.dispatchEvent(new CustomEvent("svelte-drag",{detail:s})),ne?.(s)}let p=addEventListener;p("touchstart",A,!1),p("touchend",B,!1),p("touchmove",O,!1),p("mousedown",A,!1),p("mouseup",B,!1),p("mousemove",O,!1),e.style.touchAction="none";let J=()=>{let t=e.offsetWidth/g.width;return isNaN(t)&&(t=1),t};function A(t){if(x||H&&t.type==="touchstart"&&t.touches.length>1)return;if(e.classList.add(S),P=Ee(h,e),U=ye(m,e),w=["both","x"].includes(a),k=["both","y"].includes(a),typeof r!="undefined"&&(f=De(r,e)),g=e.getBoundingClientRect(),ee(h)&&ee(m)&&h===m)throw new Error("`handle` selector can't be same as `cancel` selector");if(U?.contains(P))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(P.contains(t.target)&&!U?.contains(t.target)&&(D=!0),!D)return;i&&(K=document.body.style.userSelect,document.body.style.userSelect="none"),oe(e);let{clientX:s,clientY:G}=Q(t)?t.touches[0]:t,u=J();w&&(M=s-C/u),k&&(T=G-R/u),f&&(z=s-g.left,I=G-g.top)}function B(){!D||(e.classList.remove(Y),e.classList.add(y),i&&(document.body.style.userSelect=K),ie(e),w&&(M=l),w&&(T=c),D=!1)}function O(t){if(!D)return;e.classList.add(Y),t.preventDefault(),g=e.getBoundingClientRect();let{clientX:s,clientY:G}=Q(t)?t.touches[0]:t,[u,L]=[s,G],N=J();if(f){let d={left:f.left+z,top:f.top+I,right:f.right+z-g.width,bottom:f.bottom+I-g.height};u=Z(u,d.left,d.right),L=Z(L,d.top,d.bottom)}if(Array.isArray(v)){let[d,V]=v;if(isNaN(+d)||d<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+V)||V<0)throw new Error("2nd argument of `grid` must be a valid positive number");let[W,$]=[u-M,L-T];[W,$]=ve([Math.floor(d/N),Math.floor(V/N)],W,$),[u,L]=[M+W,T+$]}w&&(l=(u-M)*N),k&&(c=(L-T)*N),[C,R]=[l,c],se(e),F.then(()=>j(l,c,e,o))}return{destroy:()=>{let t=removeEventListener;t("touchstart",A,!1),t("touchend",B,!1),t("touchmove",O,!1),t("mousedown",A,!1),t("mouseup",B,!1),t("mousemove",O,!1)},update:t=>{a=t.axis||"both",x=t.disabled??!1,H=t.ignoreMultitouch??!1,h=t.handle,r=t.bounds,m=t.cancel,i=t.applyUserSelectHack??!0,v=t.grid,o=t.gpuAcceleration??!0;let s=e.classList.contains(y);e.classList.remove(S,y),S=t.defaultClass??b.MAIN,Y=t.defaultClassDragging??b.DRAGGING,y=t.defaultClassDragged??b.DRAGGED,e.classList.add(S),s&&e.classList.add(y),ae&&(C=l=t.position?.x??l,R=c=t.position?.y??c,F.then(()=>j(l,c,e,o)))}}};function Q(e){return Boolean(e.touches&&e.touches.length)}function Z(e,n,r){return Math.min(Math.max(e,n),r)}function ee(e){return typeof e=="string"}var ve=_(([e,n],r,a)=>{let o=Math.round(r/e)*e,i=Math.round(a/n)*n;return[o,i]});function Ee(e,n){if(!e)return n;if(e instanceof HTMLElement)return e;let r=n.querySelector(e);if(r===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return r}function ye(e,n){if(!e)return;if(e instanceof HTMLElement)return e;let r=n.querySelector(e);if(r===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return r}function De(e,n){if(e instanceof HTMLElement)return e.getBoundingClientRect();if(typeof e=="object"){let[o,i]=[window.innerWidth,window.innerHeight],{top:x=0,left:H=0,right:v=0,bottom:E=0}=e,m=o-v,h=i-E;return{top:x,right:m,bottom:h,left:H}}if(e==="parent")return n.parentNode.getBoundingClientRect();let r=document.querySelector(e);if(r===null)throw new Error("The selector provided for bound doesn't exists in the document.");return r.getBoundingClientRect()}function j(e,n,r,a){r.style.transform=a?`translate3d(${+e}px, ${+n}px, 0)`:`translate(${+e}px, ${+n}px)`}export{Le as draggable};
//# sourceMappingURL=index.js.map