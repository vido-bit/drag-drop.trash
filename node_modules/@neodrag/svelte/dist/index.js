function t(t,e,n,o){var r,i=null==(r=o)||"number"==typeof r||"boolean"==typeof r?o:n(o),a=e.get(i);return void 0===a&&(a=t.call(this,o),e.set(i,a)),a}function e(t,e,n){var o=Array.prototype.slice.call(arguments,3),r=n(o),i=e.get(r);return void 0===i&&(i=t.apply(this,o),e.set(r,i)),i}function n(n,o){return function(t,e,n,o,r){return n.bind(e,t,o,r)}(n,this,1===n.length?t:e,o.cache.create(),o.serializer)}const o=JSON.stringify;function r(){this.cache=Object.create(null)}r.prototype.has=function(t){return t in this.cache},r.prototype.get=function(t){return this.cache[t]},r.prototype.set=function(t,e){this.cache[t]=e};var i={create:function(){return new r}};const a=(t,e={})=>{let{bounds:n,axis:o="both",gpuAcceleration:r=!0,applyUserSelectHack:i=!0,disabled:a=!1,ignoreMultitouch:d=!1,grid:h,position:f,cancel:g,handle:m,defaultClass:y="neodrag",defaultClassDragging:b="neodrag-dragging",defaultClassDragged:w="neodrag-dragged",defaultPosition:v={x:0,y:0},onDragStart:E,onDrag:x,onDragEnd:C}=e;const S=new Promise(requestAnimationFrame);let M,D,N=!1,A=0,R=0,B=0,H=0,L=0,q=0,{x:T,y:$}=f?{x:f?.x??0,y:f?.y??0}:v;p(T,$,t,r);let z,X,Y,j,k="",O=!!f;const P=document.body.style,U=t.classList,W=(e,n)=>{const o={offsetX:A,offsetY:R,domRect:t.getBoundingClientRect()};t.dispatchEvent(new CustomEvent(e,{detail:o})),n?.(o)};const F=addEventListener;F("touchstart",G,!1),F("touchend",I,!1),F("touchmove",K,!1),F("mousedown",G,!1),F("mouseup",I,!1),F("mousemove",K,!1),t.style.touchAction="none";const J=()=>{let e=t.offsetWidth/X.width;return isNaN(e)&&(e=1),e};function G(e){if(a)return;if(d&&"touchstart"===e.type&&e.touches.length>1)return;if(U.add(y),Y=function(t,e){if(!t)return e;if(t instanceof HTMLElement)return t;const n=e.querySelector(t);if(null===n)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return n}(m,t),j=function(t,e){if(!t)return;if(t instanceof HTMLElement)return t;const n=e.querySelector(t);if(null===n)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return n}(g,t),M=/(both|x)/.test(o),D=/(both|y)/.test(o),void 0!==n&&(z=function(t,e){if(t instanceof HTMLElement)return t.getBoundingClientRect();if("object"==typeof t){const{top:e=0,left:n=0,right:o=0,bottom:r=0}=t;return{top:e,right:window.innerWidth-o,bottom:window.innerHeight-r,left:n}}if("parent"===t)return e.parentNode.getBoundingClientRect();const n=document.querySelector(t);if(null===n)throw new Error("The selector provided for bound doesn't exists in the document.");return n.getBoundingClientRect()}(n,t)),X=t.getBoundingClientRect(),l(m)&&l(g)&&m===g)throw new Error("`handle` selector can't be same as `cancel` selector");if(j?.contains(Y))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(Y.contains(e.target)&&!j?.contains(e.target)&&(N=!0),!N)return;i&&(k=P.userSelect,P.userSelect="none"),W("neodrag:start",E);const{clientX:r,clientY:s}=c(e)?e.touches[0]:e,u=J();M&&(B=r-T/u),D&&(H=s-$/u),z&&(L=r-X.left,q=s-X.top)}function I(){N&&(U.remove(b),U.add(w),i&&(P.userSelect=k),W("neodrag:end",C),M&&(B=A),M&&(H=R),N=!1)}function K(e){if(!N)return;U.add(b),e.preventDefault(),X=t.getBoundingClientRect();const{clientX:n,clientY:o}=c(e)?e.touches[0]:e;let i=n,a=o;const l=J();if(z){const t={left:z.left+L,top:z.top+q,right:z.right+L-X.width,bottom:z.bottom+q-X.height};i=s(i,t.left,t.right),a=s(a,t.top,t.bottom)}if(Array.isArray(h)){let[t,e]=h;if(isNaN(+t)||t<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+e)||e<0)throw new Error("2nd argument of `grid` must be a valid positive number");let n=i-B,o=a-H;[n,o]=u([Math.floor(t/l),Math.floor(e/l)],n,o),i=B+n,a=H+o}M&&(A=(i-B)*l),D&&(R=(a-H)*l),T=A,$=R,W("neodrag",x),S.then((()=>p(A,R,t,r)))}return{destroy:()=>{const t=removeEventListener;t("touchstart",G,!1),t("touchend",I,!1),t("touchmove",K,!1),t("mousedown",G,!1),t("mouseup",I,!1),t("mousemove",K,!1)},update:e=>{o=e.axis||"both",a=e.disabled??!1,d=e.ignoreMultitouch??!1,m=e.handle,n=e.bounds,g=e.cancel,i=e.applyUserSelectHack??!0,h=e.grid,r=e.gpuAcceleration??!0;const c=U.contains(w);U.remove(y,w),y=e.defaultClass??"neodrag",b=e.defaultClassDragging??"neodrag-dragging",w=e.defaultClassDragged??"neodrag-dragged",U.add(y),c&&U.add(w),O&&(T=A=e.position?.x??A,$=R=e.position?.y??R,S.then((()=>p(A,R,t,r))))}}},c=t=>!!t.touches?.length,s=(t,e,n)=>Math.min(Math.max(t,e),n),l=t=>"string"==typeof t,u=(d=([t,e],n,o)=>{const r=(t,e)=>Math.round(t/e)*e;return[r(n,t),r(o,e)]},f=h?.cache??i,g=h?.serializer??o,(h?.strategy??n)(d,{cache:f,serializer:g}));var d,h,f,g;function p(t,e,n,o){n.style.transform=o?`translate3d(${+t}px, ${+e}px, 0)`:`translate(${+t}px, ${+e}px)`}export{a as draggable};
//# sourceMappingURL=index.js.map
